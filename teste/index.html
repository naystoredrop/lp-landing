<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VSL Alta Conversión</title>
  <meta name="robots" content="noindex,nofollow" />
  <style>
    :root{ --brand:#ff6a00; --bg:#000; --fg:#fff; }
    *{box-sizing:border-box}
    body{
      margin:0; background:var(--bg); color:var(--fg);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      display:flex; justify-content:center; min-height:100vh; padding:16px;
    }
    .wrap{ width:min(100%,900px); margin:auto }

    /* Player 9:16 (vertical) */
    #vsl-box{
      position:relative; width:100%;
      padding-top:177.7777777778%;  /* 9:16 vertical */
      border-radius:16px; overflow:hidden; background:#000;
      box-shadow:0 10px 40px rgba(0,0,0,.5);
    }
    #vsl-box iframe{
      border:none; position:absolute; top:0; left:0; width:100%; height:100%;
    }

    /* CAPA GIF */
    .cover{
      position:absolute; inset:0; z-index:10;
      display:flex; align-items:center; justify-content:center;
      transition:opacity .25s ease;
    }
    .cover.hide{ opacity:0; pointer-events:none }
    .cover img{
      width:100%; height:100%; object-fit:cover;
      user-select:none; -webkit-user-drag:none;
      cursor:pointer;
    }

    /* Barra estilo VTurb */
    .progress{
      position:absolute; left:0; right:0; bottom:0;
      height:8px; background:rgba(255,255,255,.12);
      z-index:5; box-shadow:0 0 8px rgba(255,106,0,.5);
    }
    .progress span{
      display:block; height:100%; width:0%;
      background:linear-gradient(90deg,#ff6a00,#ffb347);
      transition:width .25s ease-out;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div id="vsl-box">
      <!-- CAPA (ativa o som) -->
      <div class="cover" id="cover">
        <img src="capa%20thumilai.gif" alt="Haz clic para escuchar">
      </div>

      <!-- Barra de progresso -->
      <div class="progress"><span id="bar"></span></div>
    </div>
  </div>

  <script>
    // CONFIGURAÇÃO
    const VIDEO_ID = '10d249a46e42039201d0fec47f6d1f5b';
    const VIDEO_DURATION = 4511; // 1h15m11s (em segundos)
    const box = document.getElementById('vsl-box');
    const cover = document.getElementById('cover');
    const bar = document.getElementById('bar');

    // Link Cloudflare Stream direto (iframe que funciona)
    const IFRAME_SRC =
      "https://customer-b2gdb94hrid04n5r.cloudflarestream.com/" + VIDEO_ID +
      "/iframe?autoplay=true&controls=false&playsinline=true&muted=false" +
      "&poster=" + encodeURIComponent(
        "https://customer-b2gdb94hrid04n5r.cloudflarestream.com/" +
        VIDEO_ID + "/thumbnails/thumbnail.jpg?time=&height=600"
      );

    // Injetar o iframe
    function injectIframe(){
      const old = box.querySelector('iframe');
      if(old) old.remove();
      const iframe = document.createElement('iframe');
      iframe.src = IFRAME_SRC;
      iframe.allow = "accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;";
      iframe.allowFullscreen = true;
      iframe.loading = "lazy";
      iframe.style.cssText = "border:none; position:absolute; top:0; left:0; width:100%; height:100%;";
      box.appendChild(iframe);
    }

    // Barra VTurb — responsiva e viva
    let anim=null;
    function startBar(){
      cancelAnimationFrame(anim);
      const t0 = performance.now();
      function frame(now){
        const elapsed = (now - t0)/1000;
        const n = Math.min(elapsed / VIDEO_DURATION, 1);
        const eased = Math.pow(n, 1/1.8);
        bar.style.width = (eased*100).toFixed(2) + "%";
        if(n<1) anim=requestAnimationFrame(frame);
      }
      anim=requestAnimationFrame(frame);
    }

    // Clique na capa → libera áudio e inicia vídeo
    function startVideo(){
      cover.classList.add('hide');
      injectIframe();
      startBar();
    }

    cover.addEventListener('click', startVideo, {once:true});
    cover.addEventListener('touchstart', startVideo, {once:true, passive:true});
  </script>
</body>
</html>
